## 元素概述

元素是可以在画布上渲染画面、并设置子元素的结构体。
一个元素需要提供以下几个函数

1. **渲染**。仅渲染当前元素到画布上而不考虑子元素。该函数接收一个与布局器协商后的**协商区域**[^areas]参数。当绑定的数据源发生变更需要设置组件管理器的*重新渲染标志*为`true`，并由组件管理器安排下一次渲染。
   
2. **子元素重排**。当绑定的数据源发生变更时，向组件管理器申请子元素重排和事件绑定，由组件管理器安排下一次重排时调用这个函数。

3. **渲染空间协商**。返回一个尺寸（而不是区域），或`None`（分配尽可能大的空间）。该尺寸将提供给布局器用于区域分配，然后将分配的区域结果用于渲染。

## 储存方式
元素是即时生成的，即元素是带生命周期的。在结构体内组成元素的各个成分是分开储存的。我们称带生命周期的完整结构体为**元素(element)**，称元素的静态缓存部分为**元素内核(element core)**。

一个元素储存了元素核心、props域、样式表（也是即时生成的）。
一个元素的储存结构如下（该结构体中的域的名字全部采用宏生成的随机名）：
```
元素<'a> {
    props1: &'a String,
    props2: AnotherThing<'a>,

    __core(自动解引用): &'a mut 储存单元<'static>{
        data1: String,
        data2: u32,
        __static_computed: ...,
        __anonymous_field: ...,
        ...
    },

    __style: 样式表<'a>,
}
```

[下一章：响应式数据](responsible_data.md)

[^areas]: **协商区域**：协商区域指的是与布局器商讨后，布局器返还的一块空白区域，保证该区域不会绘制任何内容，然而元素仍可以逾越该区域造成内容重叠。